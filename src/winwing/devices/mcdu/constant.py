"""Winwing MCDU constants
"""

from enum import Enum, IntEnum


class MCDU_DEVICE_MASKS(IntEnum):
    NONE = 0
    MCDU = 0x01
    CAP = 0x10
    FO = 0x20
    OBS = 0x40
    # PFP3N = 0x02
    # PFP4 = 0x04
    # PFP7 = 0x08


class MCDU_BRIGHTNESS(Enum):
    BACKLIGHT = 0  # 0 .. 255
    SCREEN_BACKLIGHT = 1  # 0 .. 255


class MCDU_ANNUNCIATORS(Enum):
    FAIL = 8
    FM = 9
    MCDU = 10
    MENU = 11
    FM1 = 12
    IND = 13
    RDY = 14
    STATUS = 15
    FM2 = 16


class MCDU_COLORS(Enum):
    AMBER = "a"
    BLUE = "b"  # cyan
    GREEN = "g"
    GREY = "e"
    GW = "Gw"
    LW = "Lw"
    MAGENTA = "m"
    RED = "r"
    SPECIAL = "s"
    WHITE = "w"
    YELLOW = "y"


COLOR_MAP = {
    "L": 0x0000,  # black with grey background
    "A": 0x0021,  # amber
    "W": 0x0042,  # white
    "B": 0x0063,  # cyan
    "G": 0x0084,  # green
    "M": 0x00A5,  # magenta
    "R": 0x00C6,  # red
    "Y": 0x00E7,  # yellow
    "E": 0x0108,  # grey
    " ": 0x0042,  # use white
}


MCDU_TERM_COLORS = {
    "a": "\033[38;5;208m",  # amber, dark yellow
    "b": "\033[38;5;39m",
    "g": "\033[38;5;46m",
    "m": "\033[38;5;165m",
    "w": "\033[38;5;231m",
    "y": "\033[38;5;226m",
    "s": "\033[38;5;196m",  # special characters, not a color
    "Lw": "\033[38;5;15m",  # bold white, bright white
    "Lg": "\033[38;5;10m",  # bold white, bright green
}


class MCDU_COLOR(Enum):
    AMBER = "a"
    BLUE = "b"
    CYAN = "b"
    MAGENTA = "m"
    WHITE = "w"
    GREEN = "g"
    DEFAULT = "w"
    YELLOW = "y"
    SPECIAL = "s"
    L_WHITE = "Lw"
    L_GREEN = "Lg"


# Constants
PAGE_LINES = 14  # Header + 6 * label + 6 * cont + textbox
PAGE_CHARS_PER_LINE = 24
PAGE_BYTES_PER_CHAR = 3
PAGE_BYTES_PER_LINE = PAGE_CHARS_PER_LINE * PAGE_BYTES_PER_CHAR
PAGE_BYTES_PER_PAGE = PAGE_BYTES_PER_LINE * PAGE_LINES

# #######################################@
# Collection
#

AIRCRAFT_DATAREF = "sim/aircraft/view/acf_ICAO"
VALID_ICAO_AIRCRAFTS = {
    "A321",
    "A21N",
    "A319",
    "A320",
    "A339",
    "A350",
}


# List of datarefs without led connection to request
# Text Dataref format:  <MCDU[1,2]><Line[title/label/cont/etc]><Linenumber[1...6]><Color[a,b,m,s,w,y]>.
# We must read all 25 Bytes per dataref!


# List of MCDU keys
class ButtonType(Enum):
    SWITCH = 0
    TOGGLE = 1
    NONE = 5


class DrefType(Enum):
    DATA = 0
    CMD = 1
    NONE = 2


def MCDU_INIT_SEQUENCE(background_color: list) -> list:
    return [
        [
            0xF0,
            0x0,
            0x1,
            0x38,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x1E,
            0x1,
            0x0,
            0x0,
            0xC4,
            0x24,
            0xA,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x18,
            0x1,
            0x0,
            0x0,
            0xC4,
            0x24,
            0xA,
            0x0,
            0x0,
            0x8,
            0x0,
            0x0,
            0x0,
            0x34,
            0x0,
            0x18,
            0x0,
            0xE,
            0x0,
            0x18,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0xC4,
            0x24,
            0xA,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x0,
        ],
        [
            0xF0,
            0x0,
            0x2,
            0x38,
            0x0,
            0x0,
            0x0,
            0x1,
            0x0,
            0x5,
            0x0,
            0x0,
            0x0,
            0x2,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0xC4,
            0x24,
            0xA,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x1,
            0x0,
            0x6,
            0x0,
            0x0,
            0x0,
            0x3,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
        ],
        [
            0xF0,
            0x0,
            0x3,
            0x38,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x2,
            0x0,
            0x0,
            0x0,
            0x0,
            0xFF,
            0x4,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x2,
            0x0,
            0x0,
            0xA5,
            0xFF,
            0xFF,
            0x5,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x0,
            0x0,
        ],
        [
            0xF0,
            0x0,
            0x4,
            0x38,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x2,
            0x0,
            0xFF,
            0xFF,
            0xFF,
            0xFF,
            0x6,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x2,
            0x0,
            0xFF,
            0xFF,
            0x0,
            0xFF,
            0x7,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
        ],
        [
            0xF0,
            0x0,
            0x5,
            0x38,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x2,
            0x0,
            0x3D,
            0xFF,
            0x0,
            0xFF,
            0x8,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x2,
            0x0,
            0xFF,
            0x63,
            0x0,
            0x0,
            0x0,
            0x0,
        ],
        [
            0xF0,
            0x0,
            0x6,
            0x38,
            0xFF,
            0xFF,
            0x9,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x2,
            0x0,
            0x0,
            0x0,
            0xFF,
            0xFF,
            0xA,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
        ],
        [
            0xF0,
            0x0,
            0x7,
            0x38,
            0x0,
            0x0,
            0x2,
            0x0,
            0x0,
            0xFF,
            0xFF,
            0xFF,
            0xB,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x2,
            0x0,
            0x42,
            0x5C,
            0x61,
            0xFF,
            0xC,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x0,
            0x0,
            0x0,
            0x0,
        ],
        [
            0xF0,
            0x0,
            0x8,
            0x38,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x2,
            0x0,
            0x77,
            0x77,
            0x77,
            0xFF,
            0xD,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x2,
            0x0,
            0x5E,
            0x73,
            0x79,
            0xFF,
            0xE,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
        ],
        [
            0xF0,
            0x0,
            0x9,
            0x38,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x3,
            0x0,
            background_color[0],
            background_color[1],
            background_color[2],
            0xFF,
            0xF,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x3,
            0x0,
            0x0,
            0xA5,
            0xFF,
            0xFF,
            0x10,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
        ],
        [
            0xF0,
            0x0,
            0xA,
            0x38,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x3,
            0x0,
            0xFF,
            0xFF,
            0xFF,
            0xFF,
            0x11,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x3,
            0x0,
            0xFF,
            0xFF,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
        ],
        [
            0xF0,
            0x0,
            0xB,
            0x38,
            0xFF,
            0x12,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x3,
            0x0,
            0x3D,
            0xFF,
            0x0,
            0xFF,
            0x13,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
        ],
        [
            0xF0,
            0x0,
            0xC,
            0x38,
            0x0,
            0x3,
            0x0,
            0xFF,
            0x63,
            0xFF,
            0xFF,
            0x14,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x3,
            0x0,
            0x0,
            0x0,
            0xFF,
            0xFF,
            0x15,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x0,
            0x0,
            0x0,
            0x0,
        ],
        [
            0xF0,
            0x0,
            0xD,
            0x38,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x3,
            0x0,
            0x0,
            0xFF,
            0xFF,
            0xFF,
            0x16,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x3,
            0x0,
            0x42,
            0x5C,
            0x61,
            0xFF,
            0x17,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
        ],
        [
            0xF0,
            0x0,
            0xE,
            0x38,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x3,
            0x0,
            0x77,
            0x77,
            0x77,
            0xFF,
            0x18,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x3,
            0x0,
            0x5E,
            0x73,
            0x79,
            0xFF,
            0x19,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
        ],
        [
            0xF0,
            0x0,
            0xF,
            0x38,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x4,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x1A,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x4,
            0x0,
            0x1,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
        ],
        [
            0xF0,
            0x0,
            0x10,
            0x38,
            0x1B,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x4,
            0x0,
            0x2,
            0x0,
            0x0,
            0x0,
            0x1C,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x1A,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0x1,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
        ],
        [
            0xF0,
            0x0,
            0x11,
            0x12,
            0x2,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x1C,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
        ],
    ]
