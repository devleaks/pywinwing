"""Winwing MCDU constants
"""

from dataclasses import dataclass
from enum import Enum, IntEnum


# #######################################@
# Device and application constant
#
class MCDU_STATUS(IntEnum):
    """Global MCDU adapter status"""

    NOT_RUNNING = 0
    CONNECTED = 1
    AIRCRAFT_DETECTED = 2
    WAITING_FOR_DATA = 3
    RUNNING = 9


class MCDU_DEVICE_MASKS(IntEnum):
    NONE = 0
    MCDU = 0x01
    CAP = 0x10
    FO = 0x20
    OBS = 0x40
    # PFP3N = 0x02
    # PFP4 = 0x04
    # PFP7 = 0x08


class MCDU_BRIGHTNESS(Enum):
    BACKLIGHT = 0  # 0 .. 255
    SCREEN_BACKLIGHT = 1  # 0 .. 255


class MCDU_ANNUNCIATORS(Enum):
    FAIL = 8
    FM = 9
    MCDU = 10
    MENU = 11
    FM1 = 12
    IND = 13
    RDY = 14
    STATUS = 15
    FM2 = 16


# #######################################@
# Display Constants
#
PAGE_LINES = 14  # Header + 6 * label + 6 * cont + textbox
PAGE_CHARS_PER_LINE = 24
PAGE_BYTES_PER_CHAR = 3
PAGE_BYTES_PER_LINE = PAGE_CHARS_PER_LINE * PAGE_BYTES_PER_CHAR
PAGE_BYTES_PER_PAGE = PAGE_BYTES_PER_LINE * PAGE_LINES

# #######################################@
# Special datarefs for application management
#
AUTHOR_DATAREF = "sim/aircraft/view/acf_author"
ICAO_DATAREF = "sim/aircraft/view/acf_ICAO"
AIRCRAFT_DATAREFS = [AUTHOR_DATAREF, ICAO_DATAREF]


# #######################################@
# List of MCDU keys
#
class ButtonType(Enum):
    SWITCH = 0
    TOGGLE = 1
    NONE = 5


class DrefType(Enum):
    DATA = 0
    CMD = 1
    NONE = 2


@dataclass
class Button:
    """Wrapper class around a MCDU key"""

    id: int
    label: str
    dataref: str | None = None
    dreftype: DrefType = DrefType.DATA
    type: ButtonType = ButtonType.NONE
    led: MCDU_ANNUNCIATORS | None = None


# #######################################@
# Colors (up to 10 colors)
#
@dataclass
class Color:
    """Wrapper class around a color key"""

    name: str
    key: str
    ww_mask: bytes
    term: str
    rgb: tuple  # this color will be used on display


BACKGROUND_COLOR = [0x00, 0x00, 0x00]


class COLORS(Enum):
    BLACK = Color(name="black", key="l", ww_mask=0x0000, term="\033[38;5;0m", rgb=(0, 0, 0))  # L
    AMBER = Color(name="amber", key="a", ww_mask=0x0021, term="\033[38;5;208m", rgb=(255, 179, 0))
    WHITE = Color(name="white", key="w", ww_mask=0x0042, term="\033[38;5;231m", rgb=(255, 255, 255))
    CYAN = Color(name="cyan", key="b", ww_mask=0x0063, term="\033[38;5;39m", rgb=(0, 255, 255))
    GREEN = Color(name="green", key="g", ww_mask=0x0084, term="\033[38;5;46m", rgb=(0, 255, 61))
    MAGENTA = Color(name="magenta", key="m", ww_mask=0x00A5, term="\033[38;5;165m", rgb=(255, 99, 255))
    RED = Color(name="red", key="r", ww_mask=0x00C6, term="\033[38;5;196m", rgb=(255, 0, 0))
    YELLOW = Color(name="yellow", key="y", ww_mask=0x00E7, term="\033[38;5;226m", rgb=(255, 255, 0))
    YGREY = Color(name="yellowgrey", key="x", ww_mask=0x0108, term="\033[38;5;221m", rgb=(97, 92, 66))  # X
    GREY = Color(name="grey", key="e", ww_mask=0x0129, term="\033[38;5;251m", rgb=(119, 119, 119))  # E
    DEFAULT = Color(name="white", key="w", ww_mask=0x0042, term="\033[38;5;231m", rgb=(255, 255, 255))

    @property
    def name(self) -> str:
        return self.value.name

    @property
    def key(self) -> str:
        return self.value.key

    @property
    def ww_mask(self) -> bytes:
        return self.value.ww_mask

    @property
    def term(self) -> str:
        return self.value.term

    @property
    def rgb(self) -> tuple:
        return self.value.rgb


def BUILD_INIT_SEQUENCE() -> list:
    def reverse(a):
        a = list(a)
        a.reverse()
        return a

    colors = {c.ww_mask: reverse(c.rgb) for c in COLORS}

    return [
        [
            0xF0,
            0x0,
            0x1,
            0x38,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x1E,
            0x1,
            0x0,
            0x0,
            0xC4,
            0x24,
            0xA,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x18,
            0x01,
            0x0,
            0x0,
            0xC4,
            0x24,
            0xA,
            0x0,
            0x0,
            0x8,
            0x0,
            0x0,
            0x0,
            0x34,
            0x0,
            0x18,
            0x0,
            0xE,
            0x0,
            0x18,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0xC4,
            0x24,
            0xA,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x0,
        ],
        [
            0xF0,
            0x0,
            0x2,
            0x38,
            0x0,
            0x0,
            0x0,
            0x1,
            0x0,
            0x5,
            0x0,
            0x0,
            0x0,
            0x2,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0xC4,
            0x24,
            0xA,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x1,
            0x0,
            0x6,
            0x0,
            0x0,
            0x0,
            0x3,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
        ],
        [
            0xF0,
            0x0,
            0x3,
            0x38,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x2,
            0x0,
            colors[0x00][0],
            colors[0x00][1],
            colors[0x00][2],
            0xFF,
            0x4,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x2,
            0x0,
            colors[0x21][0],
            colors[0x21][1],
            colors[0x21][2],
            0xFF,
            0x5,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x0,
            0x0,
        ],
        [
            0xF0,
            0x0,
            0x4,
            0x38,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x2,
            0x0,
            colors[0x42][0],
            colors[0x42][1],
            colors[0x42][2],
            0xFF,
            0x6,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x2,
            0x0,
            colors[0x63][0],
            colors[0x63][1],
            colors[0x63][2],
            0xFF,
            0x7,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
        ],
        [
            0xF0,
            0x0,
            0x5,
            0x38,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x2,
            0x0,
            colors[0x84][0],
            colors[0x84][1],
            colors[0x84][2],
            0xFF,
            0x8,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x2,
            0x0,
            0xFF,
            0x63,
            0x0,
            0x0,
            0x0,
            0x0,
        ],
        [
            0xF0,
            0x0,
            0x6,
            0x38,
            0xFF,
            0xFF,
            0x9,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x2,
            0x0,
            colors[0xC6][0],
            colors[0xC6][1],
            colors[0xC6][2],
            0xFF,
            0xA,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
        ],
        [
            0xF0,
            0x0,
            0x7,
            0x38,
            0x0,
            0x0,
            0x2,
            0x0,
            colors[0xE7][0],
            colors[0xE7][1],
            colors[0xE7][2],
            0xFF,
            0xB,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x2,
            0x0,
            colors[0x108][0],
            colors[0x108][1],
            colors[0x108][2],
            0xFF,
            0xC,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x0,
            0x0,
            0x0,
            0x0,
        ],
        [
            0xF0,
            0x0,
            0x8,
            0x38,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x2,
            0x0,
            colors[0x129][0],
            colors[0x129][1],
            colors[0x129][2],
            0xFF,
            0xD,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x2,
            0x0,
            0x5E,
            0x73,
            0x79,
            0xFF,
            0xE,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
        ],
        [
            0xF0,
            0x0,
            0x9,
            0x38,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x3,
            0x0,
            BACKGROUND_COLOR[0],
            BACKGROUND_COLOR[1],
            BACKGROUND_COLOR[2],
            0x10,
            0xF,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x3,
            0x0,
            0x0,
            0xA5,
            0xFF,
            0xFF,
            0x10,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
        ],
        [
            0xF0,
            0x0,
            0xA,
            0x38,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x3,
            0x0,
            0xFF,
            0xFF,
            0xFF,
            0xFF,
            0x11,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x3,
            0x0,
            0xFF,
            0xFF,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
        ],
        [
            0xF0,
            0x0,
            0xB,
            0x38,
            0xFF,
            0x12,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x3,
            0x0,
            0x3D,
            0xFF,
            0x0,
            0xFF,
            0x13,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
        ],
        [
            0xF0,
            0x0,
            0xC,
            0x38,
            0x0,
            0x3,
            0x0,
            colors[0xA5][0],
            colors[0xA5][1],
            colors[0xA5][2],
            0xFF,
            0x14,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x3,
            0x0,
            0x0,
            0x0,
            0xFF,
            0xFF,
            0x15,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x0,
            0x0,
            0x0,
            0x0,
        ],
        [
            0xF0,
            0x0,
            0xD,
            0x38,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x3,
            0x0,
            0x0,
            0xFF,
            0xFF,
            0xFF,
            0x16,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x3,
            0x0,
            0x42,
            0x5C,
            0x61,
            0xFF,
            0x17,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
        ],
        [
            0xF0,
            0x0,
            0xE,
            0x38,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x3,
            0x0,
            0x77,
            0x77,
            0x77,
            0xFF,
            0x18,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x3,
            0x0,
            0x5E,
            0x73,
            0x79,
            0xFF,
            0x19,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
        ],
        [
            0xF0,
            0x0,
            0xF,
            0x38,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x4,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x1A,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x4,
            0x0,
            0x1,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
        ],
        [
            0xF0,
            0x0,
            0x10,
            0x38,
            0x1B,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x19,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0xE,
            0x0,
            0x0,
            0x0,
            0x4,
            0x0,
            0x2,
            0x0,
            0x0,
            0x0,
            0x1C,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x1A,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0x1,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
        ],
        [
            0xF0,
            0x0,
            0x11,
            0x12,
            0x2,
            0x32,
            0xBB,
            0x0,
            0x0,
            0x1C,
            0x1,
            0x0,
            0x0,
            0x76,
            0x72,
            0x19,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
            0x0,
        ],
    ]


MCDU_INIT_SEQUENCE = BUILD_INIT_SEQUENCE()
